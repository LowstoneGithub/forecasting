---
title: "forecasting"
output: html_document
date: "2024-03-13"
---
```{r}
#Install and load necessary packages
packages <- c("fpp3","knitr")
for (package in packages) {
  if (!requireNamespace(package, quietly = TRUE)) {
    install.packages(package)
  }
}
lapply(packages,library, character.only=T)
```

```{r}
yts_df <- read.csv("yts.csv")
```

```{r}
#Clean dataframe
yts_df_new <- yts_df%>%
  filter(DataSource == "YTS", TopicDesc == c("Cigarette Use (Youth)","Smokeless Tobacco Use (Youth)"))
```

```{r}
#Time series
# Konvertieren Sie Ihre Daten in ein tsibble
# Assuming yts_df_new is the dataframe you are working with
# and you need to include additional variables to ensure uniqueness
yts_tsibble <- as_tsibble(yts_df_new, index = YEAR, key = names(yts_df_new)[!names(yts_df_new) %in% "YEAR"])

```

```{r}
yts_tsibble%>%
  summarise(meanPrev = mean(Data_Value, na.rm=T))%>%
  autoplot(meanPrev)
```


```{r}
# Plot time series for each level of Education
yts_tsibble %>%
  group_by(Education) %>%
  summarise(meanPrev = mean(Data_Value, na.rm = TRUE)) %>%
  ggplot(aes(x = YEAR, y = meanPrev, group = Education, color = Education)) + 
    geom_line() +
    labs(title = "Time Series of Mean Prevalence by Education Level",
         x = "Year",
         y = "Mean Prevalence (%)") +
    theme_minimal() +
    scale_color_brewer(palette = "Set1")  # Using a color palette for clarity
```

```{r}
# Plot time series for each level of Education
yts_tsibble %>%
  group_by(Gender) %>%
  summarise(meanPrev = mean(Data_Value, na.rm = TRUE)) %>%
  ggplot(aes(x = YEAR, y = meanPrev, group = Gender, color = Gender)) + 
    geom_line() +
    labs(title = "Time Series of Mean Prevalence by Gender",
         x = "Year",
         y = "Mean Prevalence (%)") +
    theme_minimal() +
    scale_color_brewer(palette = "Set1")  # Using a color palette for clarity
```

```{r}
# Plot time series for each level of Education
yts_tsibble %>%
  group_by(Response) %>%
  summarise(meanPrev = mean(Data_Value, na.rm = TRUE)) %>%
  ggplot(aes(x = YEAR, y = meanPrev, group = Response, color = Response)) + 
    geom_line() +
    labs(title = "Time Series of Mean Prevalence by Response",
         x = "Year",
         y = "Mean Prevalence (%)") +
    theme_minimal() +
    scale_color_brewer(palette = "Set1")  # Using a color palette for clarity
```
```{r}
# Plot time series for each level of Education
yts_tsibble %>%
  group_by(TopicDesc) %>%
  summarise(meanPrev = mean(Data_Value, na.rm = TRUE)) %>%
  ggplot(aes(x = YEAR, y = meanPrev, group = TopicDesc, color = TopicDesc)) + 
    geom_line() +
    labs(title = "Time Series of Mean Prevalence by Topic",
         x = "Year",
         y = "Mean Prevalence (%)") +
    theme_minimal() +
    scale_color_brewer(palette = "Set1")  # Using a color palette for clarity
```

